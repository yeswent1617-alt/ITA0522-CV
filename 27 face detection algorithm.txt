import cv2

# 1. Load the pre-trained Haar Cascade classifier for face detection
# OpenCV provides this XML file by default in its data folder
face_cascade = cv2.CascadeClassifier(cv2.data.haarcascades + 'haarcascade_frontalface_default.xml')

# 2. Read the input image
img = cv2.imread(r'face.jpeg')

if img is None:
    print("Error: Could not load image.")
else:
    # 3. Convert image to grayscale (Haar Caascades require grayscale)
    gray = cv2.cvtColor(img, cv2.COLOR_BGR2GRAY)

    # 4. Detect faces
    # scaleFactor: Parameter specifying how much the image size is reduced at each image scale
    # minNeighbors: Parameter specifying how many neighbors each candidate rectangle should have to retain it
    faces = face_cascade.detectMultiScale(gray, scaleFactor=1.1, minNeighbors=5, minSize=(30, 30))

    # 5. Draw rectangles around the detected faces
    for (x, y, w, h) in faces:
        cv2.rectangle(img, (x, y), (x + w, y + h), (255, 0, 0), 2)
        cv2.putText(img, 'Face', (x, y-10), cv2.FONT_HERSHEY_SIMPLEX, 0.9, (255, 0, 0), 2)

    # 6. Display the output
    cv2.imshow('Face Detection', img)
    print(f"Detected {len(faces)} face(s).")
    
    cv2.waitKey(0)
    cv2.destroyAllWindows()
