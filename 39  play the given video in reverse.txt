import cv2

def play_video_reverse_slow_memory_efficient(video_path):
    # 1. Open the video
    cap = cv2.VideoCapture(video_path)
    
    if not cap.isOpened():
        print("Error: Could not open video.")
        return

    # 2. Get total number of frames
    total_frames = int(cap.get(cv2.CAP_PROP_FRAME_COUNT))
    print(f"Total frames to process: {total_frames}")

    # 3. Start from the last frame index and go backwards to 0
    # Range: (start, stop, step)
    for frame_idx in range(total_frames - 1, -1, -1):
        
        # Set the current position of the video file to frame_idx
        cap.set(cv2.CAP_PROP_POS_FRAMES, frame_idx)
        
        ret, frame = cap.read()
        if not ret:
            break

        # 4. Display the frame
        cv2.imshow('Reverse Slow Motion (Memory Efficient)', frame)

        # 5. Slow Motion: increase waitKey value (e.g., 100ms)
        if cv2.waitKey(100) & 0xFF == ord('q'):
            break

    cap.release()
    cv2.destroyAllWindows()

# Run the function
play_video_reverse_slow_memory_efficient(r'C:\Users\HP\Documents\openCV\car.mp4')
